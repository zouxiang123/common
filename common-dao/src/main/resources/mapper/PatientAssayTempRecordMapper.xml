<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xtt.common.dao.mapper.PatientAssayTempRecordMapper" >
  <resultMap id="BaseResultMap" type="com.xtt.common.dao.model.PatientAssayTempRecord" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 01 14:28:10 CST 2016.
    -->
    <result column="id" property="id" jdbcType="BIGINT" />
    <result column="fk_patient_id" property="fkPatientId" jdbcType="BIGINT" />
    <result column="assay_date" property="assayDate" jdbcType="VARCHAR" />
    <result column="assay_month" property="assayMonth" jdbcType="VARCHAR" />
    <result column="item_code" property="itemCode" jdbcType="VARCHAR" />
    <result column="item_name" property="itemName" jdbcType="VARCHAR" />
    <result column="result" property="result" jdbcType="VARCHAR" />
    <result column="result_tips" property="resultTips" jdbcType="VARCHAR" />
    <result column="fk_tenant_id" property="fkTenantId" jdbcType="INTEGER" />
  </resultMap>
  <insert id="insert" parameterType="com.xtt.common.dao.model.PatientAssayTempRecord" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 01 14:28:10 CST 2016.
    -->
    insert into patient_assay_temp_record (id, fk_patient_id, assay_date, 
      assay_month, item_code, item_name, 
      result, result_tips, fk_tenant_id
      )
    values (#{id,jdbcType=BIGINT}, #{fkPatientId,jdbcType=BIGINT}, #{assayDate,jdbcType=VARCHAR}, 
      #{assayMonth,jdbcType=VARCHAR}, #{itemCode,jdbcType=VARCHAR}, #{itemName,jdbcType=VARCHAR}, 
      #{result,jdbcType=VARCHAR}, #{resultTips,jdbcType=VARCHAR}, #{fkTenantId,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.xtt.common.dao.model.PatientAssayTempRecord" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 01 14:28:10 CST 2016.
    -->
    insert into patient_assay_temp_record
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="fkPatientId != null" >
        fk_patient_id,
      </if>
      <if test="assayDate != null" >
        assay_date,
      </if>
      <if test="assayMonth != null" >
        assay_month,
      </if>
      <if test="itemCode != null" >
        item_code,
      </if>
      <if test="itemName != null" >
        item_name,
      </if>
      <if test="result != null" >
        result,
      </if>
      <if test="resultTips != null" >
        result_tips,
      </if>
      <if test="fkTenantId != null" >
        fk_tenant_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=BIGINT},
      </if>
      <if test="fkPatientId != null" >
        #{fkPatientId,jdbcType=BIGINT},
      </if>
      <if test="assayDate != null" >
        #{assayDate,jdbcType=VARCHAR},
      </if>
      <if test="assayMonth != null" >
        #{assayMonth,jdbcType=VARCHAR},
      </if>
      <if test="itemCode != null" >
        #{itemCode,jdbcType=VARCHAR},
      </if>
      <if test="itemName != null" >
        #{itemName,jdbcType=VARCHAR},
      </if>
      <if test="result != null" >
        #{result,jdbcType=VARCHAR},
      </if>
      <if test="resultTips != null" >
        #{resultTips,jdbcType=VARCHAR},
      </if>
      <if test="fkTenantId != null" >
        #{fkTenantId,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  
  <!-- 自定义 -->
  
  <delete id="deleteAll">
  	delete from patient_assay_temp_record
  </delete>
  
  <!-- 批量插入临时表 -->
  <insert id="insertBatchByRecord" parameterType="com.xtt.common.dao.model.PatientAssayTempRecord">
  	INSERT INTO patient_assay_temp_record
  	(fk_patient_id, item_code, item_name, result, result_tips, assay_date)
	SELECT par.fk_patient_id, par.item_code, par.item_name, par.result, par.result_tips, par.assay_date
	FROM patient_assay_record par
	LEFT JOIN dict_hospital_lab dhl ON dhl.item_code = par.item_code
	WHERE par.fk_tenant_id = #{fkTenantId}
	AND dhl.value_type = 1
	AND par.assay_date >= #{startDateStr,jdbcType=VARCHAR}
	AND par.assay_date &lt;= #{endDateStr,jdbcType=VARCHAR}
  </insert>
</mapper>