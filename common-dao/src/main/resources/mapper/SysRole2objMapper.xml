<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lt.dao.mapper.SysRole2objMapper" >
  <resultMap id="BaseResultMap" type="com.lt.dao.model.SysRole2obj" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 26 16:17:45 CST 2016.
    -->
    <result column="fk_role_id" property="fkRoleId" jdbcType="BIGINT" />
    <result column="fk_obj_key" property="fkObjKey" jdbcType="VARCHAR" />
    <result column="fk_tenant_id" property="fkTenantId" jdbcType="INTEGER" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="create_user_id" property="createUserId" jdbcType="BIGINT" />
    <result column="update_time" property="updateTime" jdbcType="TIMESTAMP" />
    <result column="update_user_id" property="updateUserId" jdbcType="BIGINT" />
  </resultMap>
  <insert id="insert" parameterType="com.lt.dao.model.SysRole2obj" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 26 16:17:45 CST 2016.
    -->
    insert into sys_role2obj (fk_role_id, fk_obj_key, fk_tenant_id, 
      create_time, create_user_id, update_time, 
      update_user_id)
    values (#{fkRoleId,jdbcType=BIGINT}, #{fkObjKey,jdbcType=VARCHAR}, #{fkTenantId,jdbcType=INTEGER}, 
      #{createTime,jdbcType=TIMESTAMP}, #{createUserId,jdbcType=BIGINT}, #{updateTime,jdbcType=TIMESTAMP}, 
      #{updateUserId,jdbcType=BIGINT})
  </insert>
  <insert id="insertSelective" parameterType="com.lt.dao.model.SysRole2obj" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 26 16:17:45 CST 2016.
    -->
    insert into sys_role2obj
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="fkRoleId != null" >
        fk_role_id,
      </if>
      <if test="fkObjKey != null" >
        fk_obj_key,
      </if>
      <if test="fkTenantId != null" >
        fk_tenant_id,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
      <if test="createUserId != null" >
        create_user_id,
      </if>
      <if test="updateTime != null" >
        update_time,
      </if>
      <if test="updateUserId != null" >
        update_user_id,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="fkRoleId != null" >
        #{fkRoleId,jdbcType=BIGINT},
      </if>
      <if test="fkObjKey != null" >
        #{fkObjKey,jdbcType=VARCHAR},
      </if>
      <if test="fkTenantId != null" >
        #{fkTenantId,jdbcType=INTEGER},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createUserId != null" >
        #{createUserId,jdbcType=BIGINT},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserId != null" >
        #{updateUserId,jdbcType=BIGINT},
      </if>
    </trim>
  </insert>
  
  <!-- 自定义 -->
  <delete id="deleteByRoleId">
  	delete from sys_role2obj where fk_role_id=#{roleId,jdbcType=BIGINT};
  </delete>
  
  <insert id="batchInsert">
  	insert into sys_role2obj (fk_role_id, fk_obj_key, fk_tenant_id, create_time, create_user_id, update_time, update_user_id)
    <foreach collection="array" index="index" item="item" separator=" union all ">
    	select 
    	#{item.fkRoleId,jdbcType=BIGINT},
        #{item.fkObjKey,jdbcType=VARCHAR},
        #{item.fkTenantId,jdbcType=INTEGER},
        #{item.createTime,jdbcType=TIMESTAMP},
        #{item.createUserId,jdbcType=BIGINT},
        #{item.updateTime,jdbcType=TIMESTAMP},
        #{item.updateUserId,jdbcType=BIGINT}
        from dual
    </foreach>
  </insert>
  
  <delete id="batchDeleteByRoleIds">
  	DELETE from sys_role2obj WHERE fk_role_id IN 
  	<foreach collection="array" item="item" open="(" separator="," close=")">
  		#{item}
  	</foreach>
  </delete>
  
  <delete id="deleteByMenuKey">
  	DELETE from sys_role2obj WHERE 
  	fk_tenant_id =  #{tenantId,jdbcType=INTEGER}
  	AND fk_obj_key IN 
  	<foreach collection="menuKeys" item="item" open="(" separator="," close=")">
  		#{item}
  	</foreach>
  </delete>
  
  <delete id="deleteByRoleIdAndType">
  	DELETE FROM sys_role2obj WHERE fk_role_id = #{roleId} AND fk_obj_key IN
	(SELECT s.key FROM sys_obj s WHERE s.type IN 
		<foreach collection="types" item="item" open="(" separator="," close=")">
	  		#{item}
	  	</foreach>
	)
  </delete>
</mapper>